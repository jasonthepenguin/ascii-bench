# ASCII Bench

A community-driven A/B voting platform for evaluating ASCII art generated by AI models using a dynamic ELO rating system.

![ASCII Bench](https://img.shields.io/badge/Next.js-15-black?logo=next.js)
![TypeScript](https://img.shields.io/badge/TypeScript-5.9-blue?logo=typescript)
![License](https://img.shields.io/badge/license-ISC-green)

## Features

- **A/B Voting Interface**: Side-by-side comparison of ASCII art outputs
- **Dynamic ELO Rating System**: Model-level rankings with adaptive K-factors
- **Rate Limiting**: Upstash Redis-based protection (10 votes/60s per IP)
- **Real-time Leaderboard**: Live model rankings with vote counts and metadata
- **Concurrency-Safe**: PostgreSQL row-level locking prevents race conditions
- **Anonymous Voting**: No authentication required, powered by Supabase RLS

## Tech Stack

- **Framework**: Next.js 15 (App Router) with React 19
- **Language**: TypeScript
- **Database**: PostgreSQL (Supabase)
- **Caching/Rate Limiting**: Upstash Redis
- **Styling**: Tailwind CSS 4
- **ORM**: Supabase JS Client

## Getting Started

### Prerequisites

- Node.js 18+ and npm
- Supabase account (free tier works)
- Upstash Redis account (free tier works)

### Installation

1. Clone the repository:
```bash
git clone https://github.com/jasonthepenguin/ascii-bench.git
cd ascii-bench
```

2. Install dependencies:
```bash
npm install
```

3. Set up environment variables:
```bash
cp .env.example .env.local
```

Edit `.env.local` with your credentials:
```env
NEXT_PUBLIC_SUPABASE_URL=your_supabase_project_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
UPSTASH_REDIS_REST_URL=your_upstash_redis_url
UPSTASH_REDIS_REST_TOKEN=your_upstash_redis_token
```

4. Set up the database:

Run the SQL schema in your Supabase project:
```bash
# Copy contents of supabase/database.sql
# Paste into Supabase SQL Editor and run
```

5. Start the development server:
```bash
npm run dev
```

Open [http://localhost:3000](http://localhost:3000) in your browser.

## Database Schema

The project uses a PostgreSQL database with four main tables:

- **`models`**: Stores AI models with ELO ratings and vote counts
- **`ascii_outputs`**: Generated ASCII art outputs (references models and prompts)
- **`prompts`**: Text prompts used to generate ASCII art
- **`votes`**: Vote history with winner/loser tracking

See [supabase/database.sql](supabase/database.sql) for the complete schema and [ELO_SYSTEM.md](ELO_SYSTEM.md) for detailed information about the rating algorithm.

## ELO Rating System

ASCII Bench uses a sophisticated dynamic K-factor ELO system:

- **Model-level ratings**: One ELO rating per model (not per individual output)
- **Dynamic K-factor**: Starts at 32 for new models, decays to minimum 10 based on vote count
- **Concurrency-safe**: PostgreSQL functions with row-level locking
- **Fair comparisons**: New models quickly find their true rating while established models remain stable

Read the full documentation: [ELO_SYSTEM.md](ELO_SYSTEM.md)

## Project Structure

```
ascii-bench/
├── app/
│   ├── api/
│   │   ├── random-pair/   # Fetches random ASCII art pairs
│   │   └── vote/          # Handles vote submission and ELO updates
│   ├── components/
│   │   └── Navbar.tsx     # Navigation component
│   ├── leaderboard/       # Leaderboard page
│   ├── about/             # About page
│   └── page.tsx           # Main voting interface
├── lib/
│   ├── supabase.ts        # Supabase client configuration
│   └── ratelimit.ts       # Upstash Redis rate limiting
├── supabase/
│   └── database.sql       # Complete database schema
└── public/                # Static assets
```

## API Endpoints

### GET `/api/random-pair`
Returns a random prompt with two ASCII art outputs for comparison.

**Response:**
```json
{
  "prompt": { "id": "...", "prompt_text": "..." },
  "outputA": { "id": "...", "ascii_art": "...", "models": {...} },
  "outputB": { "id": "...", "ascii_art": "...", "models": {...} }
}
```

### POST `/api/vote`
Records a vote and updates ELO ratings.

**Request:**
```json
{
  "output_a_id": "uuid",
  "output_b_id": "uuid",
  "winner_id": "uuid"
}
```

**Response:**
```json
{
  "success": true,
  "elo_data": [{ "winner_new_elo": 1523, "loser_new_elo": 1477 }]
}
```

## Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

## License

ISC

## Credits

Created by [Jason Botterill](https://x.com/JasonBotterill3)

Special thanks to:
- Chris ([@chatgpt21](https://x.com/chatgpt21))
- Angel ([@Angaisb_](https://x.com/Angaisb_))
